\section{Simulation Analysis}
\label{sec:simulation}


In order to input the given circuit into the simulation software, \emph{ngspice}, we proceeded to number the existing nodes. It is fundamental to specify to which nodes each component is connected to, carefully distinguishing the positive from the negative terminal, once that this is going to affect the current value returned.

\emph{Ngspice} measures the voltages in each node and the current through any voltage source. In order to define $V_c$ one needs to have access to the current going through $R_6$. We have achieved this by adding a voltage source $V_{aux}$, with voltage $0V$, in series with $R_6$ and taking its current, since this is the same for components in series. Voltage source, $V_{aux}$, is therefore connected to nodes 0 and 8, where node 8 is located between $R_6$ and the negative terminal of $V_{aux}$.

\begin{figure}[H]
  \centering
  \includegraphics[width=10cm]{../doc/NGSpice}
  \caption{Considered circuit to input in \emph{ngspice}}
  \label{fig:fignodos}
\end{figure}

After inputing all components into \emph{ngspice}, we then ran the simulation program printing the current going through every component and the voltages in every node.


Table \ref{tab:ngspice} shows the simulated results for the circuit
under analysis.

\begin{table}[H]
  \centering
  \begin{tabular}{|l|r|}
    \hline
    {\bf Name} & {\bf Value [A or V]} \\ \hline
    \input{../sim/op_tab}
  \end{tabular}
  \caption{Operating point analysis. A variable preceded by @ is of type {\em current}
    and expressed in Ampere; other variables are of type {\it voltage} and expressed in
    Volt.}
  \label{tab:ngspice}
\end{table}

One can immediately notice that current values for the voltage sources are approximately symmetrical to the ones presented in the theoretical analysis. This is because we have considered the current in the voltage sources going from the negative terminal to the positive one. On the other hand, \emph{ngspice} considers the current the other way around, i.e., entering the positive terminal.
\par
We now proceed to calculate the discrepancies between the theoretical analysis and the simulation results:
%formula do erro
\begin{equation}
  \centering
  \epsilon (x_e)=\frac{|x_e-x_r|}{x_r} \times 100\,\%
  \label{eq:error}
\end{equation}

We have considered the value obtained by the mashes/nodes methods as the "real" one ($x_r$) and the value obtained through \emph{ngspice} as the experimental one ($x_e$). It is important to notice, once more, that the values from \emph{ngspice} for the current going through the voltages sources are simetric to the ones we have considered. The percentual error computation had this in mind.

Here, we present the obtained values for the errors.

\begin{table}[H]
  \centering
  \begin{tabular}{|l|r|}
    \hline
    {\bf Name} & {\bf Value in \%} \\ \hline
    \input{../mat/error_tensoes}
  \end{tabular}
  \caption{Voltages' percentual errors}
  \label{tab:error_tensoes}
\end{table}



\begin{table}[H]
  \centering
  \begin{tabular}{|l|r|}
    \hline
    {\bf Name} & {\bf Value in \%} \\ \hline
    \input{../mat/error_current}
  \end{tabular}
  \caption{Currents' percentual errors }
  \label{tab:error_current}
\end{table}

We have not considered the error in the $8^{th}$ node, since it is defined to be exactly 0. Therefore, the use of equation \ref{eq:error} would give us an infinite answer. However, we have presented the error for $V_a$. Although this voltage was given to us by the \emph{python} code available, \emph{ngspice} is unable to consider the same number of significant figures as the ones presented, resulting in a non-zero value.
