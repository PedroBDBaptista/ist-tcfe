\section{Theoretical Analysis}
\label{sec:theoretical}



\subsection{Gain Stage}
\par The main purpose of this part of the circuit is, as the name suggests, to increase the voltage of the output signal, producing, therefore, a high Voltage Gain.\\
We now present a more detailed of the architecture of the gain stage.

\begin{figure}[h!]
\centering
\includegraphics[width=0.5\linewidth]{gainstage.pdf}
\caption{Gain Stage Circuit}
\label{fig:gain_stage_circuit}
\end{figure}



We start by giving a simple explanation as to the exitance of some of the presented components. For example, $C_s$ is a coupling capacitor whose job is to eliminate the DC component from de voltage source $v_s$. The bias circuit (represented in red in figure \ref{fig:gain_stage_circuit}) aims to guarantee that the voltage at the source is such that allows the transistor to conduct normally, making sure it is in the forward active region.
Resistor $R_E$ is used to stabilize the temperature effects on the circuit, however, it lowers the gain. For that reason, capacitor $C_E$ is placed in parallel to it. With this configuration we can see that for low frequencies (DC) the capacitor works as an open circuit, for medium/high frequencies the capacitor works as a short circuit, bypassing $R_E$.\\

We are now interested in doing an operating point analysis of the circuit. To do so, we start by computing the Thevenin's equivalent of the bias circuit. At an operating point analysis, all capacitors behave as open circuits. We now present the circuit obtained with the Thevenin's equivalent.


\begin{figure}[h!]
\centering
\includegraphics[width=0.5\linewidth]{gainstage_equiv.pdf}
\caption{Gain Stage Circuit}
\label{fig:gain_stage_circuit}
\end{figure}


In this stage, is particularly important that we calculate the voltage $V_{CE}$ and make sure that it is greater than $V_{BEON}$ confirming that the transistor is working in the forward active region (FAR).\\

22222 The values for other important quantities will be presented alongside the ones obtained in the simulation in order to ease its analysis.\\

We shall now focus on finding a way to calculate the expected voltage gain of the circuit. We do so by considering an incremental circuit for medium frequencies. Remembering that for medium frequencies the capacitor $C_E$ behaves like a short circuit which is equivalent to consider $R_E=0$.

\begin{figure}[h!]
\centering
\includegraphics[width=0.5\linewidth]{gainstage_increm.pdf}
\caption{Gain Stage Incremetal Circuit}
\label{fig:gain_stage_incremetal_circuit}
\end{figure}

Using mesh analysis one can derive the following expressions for the voltage gain of the circuit.

\begin{equation}
v_o=-g_m(R_C||r_o)v_{\pi}
\end{equation}

\begin{equation}
v_{\pi}=\frac{r_{\pi}||R_{B1}||R_{B2}}{R_s+r_{\pi}||R_{B1}||R_{B2}}
\end{equation}

\begin{equation}
gain=\frac{v_o}{v_s}=-g_m(R_C||r_o)\frac{r_{\pi}||R_{B1}||R_{B2}}{R_s+r_{\pi}||R_{B1}||R_{B2}}
\end{equation}

One can also obtain expressions for the input and output impegances of the circuit gain. Those are as follows:


\begin{equation}
Z_I=R_{B1}||R_{B2}||r_{\pi}
\end{equation}

\begin{equation}
Z_o=R_C||r_o
\end{equation}



analyse resultsssssss!!!!???????!!!!!!??????
!!!!!!!!11
!!!!!!!!!
!!!!!!!1
!!!!!!!!



\subsection{Output Stage}
The impedances obtained from the Gain stage are not compatible neither with the input's resistance $R_s$ nor with the resistance from the speaker $R_{speaker}=8\Omega$. In order to maintain the integrity of the signal, one must aim for a large value for $Z_I$ to not degrade the input signal and a low value for $Z_o$ to not degrade the output signal.\\

We start by introducing the circuit with which we are going to work. The figure below shows the drawn circuit.

\begin{figure}[h!]
\centering
\includegraphics[width=0.5\linewidth]{output_stage.pdf}
\caption{Output Stage Circuit}
\label{fig:output_stage_figure}
\end{figure}

Much like in the previous section, we are interested in doing an operation point analysis. In such, the capacitor will behave as an open circuit and the figure \ref{fig:output stage figure} can be simplified to:

\begin{figure}[h!]
\centering
\includegraphics[width=0.5\linewidth]{output_stage_OP.pdf}
\caption{Output Stage Circuit for OP Analysis}
\label{fig:output_stage_figure_OP}
\end{figure}


Computing the voltage gain vou this section of the circuit, we end up with:

\begin{equation}
gain=\frac{v_o}{v_i}=\frac{g_m}{g_m+g{\pi}+g_E+g_o} \approx 1
\end{equation}

The impedances are given by:

\begin{equation}
Z_I=\frac{g_m+g{\pi}+g_E+g_o}{g{\pi}(g{\pi}+g_E+g_o)} \approx 1
\end{equation}


\begin{equation}
Z_o=\frac{1}{g_m+g{\pi}+g_E+g_o} \approx 1
\end{equation}